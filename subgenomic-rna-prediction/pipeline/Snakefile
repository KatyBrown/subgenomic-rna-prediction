import SGFastq
import SGErrors

start_point = config['general']["start_point"]
outdir = config['general']['output_dir']
if start_point == "sra_id":
    prefix = config["fastq"]["sra_run"]
else:
    prefix = config["fastq"]["outfile_prefix"]

rule get_fastq:
    output:
        se = f"{outdir}/fastqs/{prefix}.fq.gz",
        pe1 = f"{outdir}/fastqs/{prefix}.fq.1.gz",
        pe2 = f"{outdir}/fastqs/{prefix}.fq.2.gz"
    run:
        if start_point == "bam" or start_point == 'trimmed_fastq':
            SGFastq.touch_only(output)
        elif start_point == "raw_fastq":
            fastq_p1 = config["fastq"]["paired_end_1"]
            fastq_p2 = config["fastq"]["paired_end_2"]
            fastq_s = config["fastq"]["single_end"]
            SGFastq.zip_and_link(fastq_s,
                                 fastq_p1,
                                 fastq_p2,
                                 output)
        elif start_point == 'sra_id':
            pass
        else:
            SGErrors.bad_start_point(start_point)
